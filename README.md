# denovo_assembly_pipeline

Hello! This is Dr. Andrew Woodruff, and this repository is an attempt to turn the code/processes I used for generation of de novo assemblies using deep long- and short-read sequencing for a heterozygous, diploid organism (https://github.com/FrostFlow13/1376-denovo-assembly) into a proper scalable, semi-automated pipeline (with some intentionally manual steps).

For more information, please feel free to contact myself or Dr. Matthew Anderson (https://genetics.wisc.edu/staff/anderson-matt/), my Ph.D. advisor during my time at The Ohio State University. For some of the results that came from near-complete products of the original assembly protocol work (https://github.com/FrostFlow13/1376-denovo-assembly), please see Chapter 3 of my dissertation (http://rave.ohiolink.edu/etdc/view?acc_num=osu1712852304413336). The read dataset will be publicly available on May 5 2025 at "BioProject: PRJNA1117514". I am also more than happy to provide my in-progress _Candida albicans_ SC5314 assembly upon request (the step I last ended on was manually validating long (~8+ bp) homopolymers).

I cannot guarantee it will work for every organism or dataset, especially for organisms/strains that have low heterozygosity of their genomes or long (~75-100+ kb) tracts of homozygosity between heterozygous regions, but it worked for a CRISPR-competent strain of _Candida albicans_ SC5314 (a diploid single-celled yeast, and specifically a Chr5AB disomic derivative of AHY940 from https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5422035/, designated MAY1376).

Please do not hesitate to ask questions, as I am going on a journey here to learn either Snakemake or Nextflow for this process. I am not a CLASSICALLY trained bioinformatician or programmer beyond a few classes - I was just a graduate student/researcher at the time I made my first repository (which, in retrospect, was more just an online host for my work instruction file), but I did make a de novo, telomere-to-telomere, haplotype phased assembly. As stated above, this repository is me furthering my skills by turning it into a scalable pipeline.

______________

For full disclosure, the following was what I did prior to running this pipeline:

>For short-read sequencing, DNA was extracted from overnight cultures grown at 30°C (~10^8 cells) using the Zymogen Quick-DNA Fungal/Bacterial Miniprep Kit (Zymogen, CAT# D6005). gDNA concentration was quantified using the Qubit dsDNA Broad Range Assay Kit (Invitrogen, CAT# Q32853). Following quantification, the samples were sent to the Applied Microbiology Services Lab (AMSL) at The Ohio State University for processing. Libraries were constructed via tagmentation and dual index barcoding using a modified protocol for the Illumina (L) Tagmentation Kit (Illumina, CAT# 20040537) to produce average final fragment sizes of approximately 450-500 bp. The libraries were sequenced for 2x150 paired-end reads on an Illumina NextSeq 2000. Reads were demultiplexed and Illumina adaptors were trimmed by AMSL. Read quality was assessed using FastQC (v0.11.7), and low-quality positions were trimmed using Trimmomatic (v0.35 LEADING:20 TRAILING:20 SLIDINGWINDOW:4:20 MINLEN:35), after which the trimmed data were checked again using FastQC. Reads were mapped to the C. albicans reference genome Assembly 21 (A21-s02-m09-r10) – obtained March 2, 2021 from the Candida Genome Database website (http://www.candidagenome.org/download/sequence/C_albicans_SC5314/Assembly21/archive/C_albicans_SC5314_version_A21-s02-m09-r10_chromosomes.fasta.gz) – using Bowtie 2 (v2.2.6-2) with parameters “-3 1” to improve downstream analysis. SAMtools (v0.1.19) was then used to generate .bam files, for read sorting, and sample indexing. Read alignment quality was interrogated via visual scanning using Integrative Genomics Viewer (IGV, v2.9.2) for aneuploidy, loss of heterozygosity (LOH), and major genomic rearrangements. Secondary checks for ploidy and heterozygosity were performed using YMAP (http://lovelace.cs.umn.edu/Ymap/) for visualization. The final coverage was found to be ~80X.
>
>For long-read sequencing, an intact cell pellet of MAY1376 was sent to the University of Wisconsin-Madison’s Biotechnology Center (UWBC). UWBC performed high molecular weight DNA extraction on the sample to prepare Oxford Nanopore barcoded libraries, with DNA fragment lengths being on average ~20 kb. Libraries were then sequenced on a PromethION 24 using a FLO-PRO114M (R10.4.1) flow cell and an SQK-NBD114-24 (V14) kit for 12 hours. Prior to data delivery, basecalling was performed by UWBC using Guppy 6.4.6 (high-accuracy model, 400 bps) and reads were demultiplexed. The final coverage was found to be ~400X (we had initially asked for ~8X coverage), with ~300X coverage after removing all reads below 10 kilobases (kb) and ~200X coverage after removing all reads below 25 kb.

